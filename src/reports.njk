---
layout: layouts/base.njk
title: Reports
permalink: /reports/
---
<section class="card">
  <h2 class="text-xl font-semibold">Asset Totals</h2>
  <div id="report" class="mt-3 text-sm"></div>
</section>
<script>
(async function(){
  const el = document.getElementById('report');
  const r = await fetch('/.netlify/functions/reports-assets-summary');
  if (!r.ok) { el.textContent = 'Error'; return; }
  const { byRoom, byFloor, byHouse, rooms } = await r.json();
  const fmt = (n) => new Intl.NumberFormat(undefined, { style: 'currency', currency: 'GBP'}).format(n||0);
  const byRoomRows = rooms.map(r => `<tr><td class="py-1 pr-3">${r.name}</td><td class="py-1 text-right">${fmt(byRoom[r.id]||0)}</td></tr>`).join('');
  const floorTotals = Object.entries(byFloor).map(([f,v]) => `<tr><td class="py-1 pr-3 font-medium">${f}</td><td class="py-1 text-right font-medium">${fmt(v)}</td></tr>`).join('');
  el.innerHTML = `
    <div class="grid gap-4 sm:grid-cols-2">
      <div class="rounded-lg ring-1 ring-gray-200 bg-white/90 p-3">
        <div class="font-medium mb-2">By Room</div>
        <table>${byRoomRows}</table>
      </div>
      <div class="rounded-lg ring-1 ring-gray-200 bg-white/90 p-3">
        <div class="font-medium mb-2">By Floor</div>
        <table>${floorTotals}</table>
      </div>
    </div>
    <div class="mt-4 text-right font-semibold">House Total: ${fmt(byHouse)}</div>
  `;
})();
</script>
