---
layout: layouts/base.njk
title: Shared Shopping List
permalink: /shopping/share/
---
<section class="card">
  <h2 class="text-xl font-semibold">Shared Shopping List</h2>
  <div class="mt-3">
    <pre id="md" class="whitespace-pre-wrap text-sm"></pre>
    <div class="mt-2 flex items-center gap-2">
      <button class="btn" id="copyBtn">Copy Markdown</button>
    </div>
  </div>
</section>
<script>
(async function(){
  const params = new URLSearchParams(location.search);
  const t = params.get('t');
  const md = document.getElementById('md');
  const btn = document.getElementById('copyBtn');
  if (!t) { md.textContent = 'Missing token'; return; }
  const r = await fetch('/.netlify/functions/shopping-list-share-get?t='+encodeURIComponent(t));
  if (!r.ok) { md.textContent = 'Not found'; return; }
  const data = await r.json();
  document.title = data.title + ' â€“ Shared';
  const lines = data.items.map(i => `- [ ] ${i.name}${i.source? ' ('+i.source+')' : ''}`);
  md.textContent = lines.join('\n');
  btn.addEventListener('click', async () => { await navigator.clipboard.writeText(md.textContent); btn.textContent='Copied'; setTimeout(()=>btn.textContent='Copy Markdown', 1200); });
})();
</script>
